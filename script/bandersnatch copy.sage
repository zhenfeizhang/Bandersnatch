
p=52435875175126190479447740508185965837690552500527637822603658699938581184513
Fp=Zmod(p)


#####################################################
# Twised Edwards curve: a * x² + y² = 1 + d * x² * y²
#####################################################
TEa=Fp(52435875175126190479447740508185965837690552500527637822603658699938581184508)
TEd=Fp(45022363124591815672509500913686876175488063829319466900776701791074614335719)

# TE curve generator
TEx = Fp(29627151942733444043031429156003786749302466371339015363120350521834195802525)
TEy = Fp(27488387519748396681411951718153463804682561779047093991696427532072116857978)

assert(TEa * TEx^2 + TEy^2 - 1 - TEd * TEx^2 * TEy^2 == 0)

#####################################################
# Montgomery curve: By² = x³ + A * x² + x
#####################################################
MB=Fp(25465760566081946422412445027709227188579564747101592991722834452325077642517)
MA=Fp(29978822694968839326280996386011761570173833766074948509196803838190355340952)

assert((TEa +TEd)*2/(TEa-TEd) == MA)
assert(4/(TEa-TEd) == MB )

# M curve generator
Mx = (1+TEy)/(1-TEy)
My = Mx/TEx


assert(MB * My^2 - Mx^3 - MA * Mx^2 - Mx == 0)

#####################################################
# Weierstrass curve: y² = x³ + A * x + B
#####################################################
WA=Fp(10773120815616481058602537765553212789256758185246796157495669123169359657269)
WB=Fp(29569587568322301171008055308580903175558631321415017492731745847794083609535)

assert((3-MA^2)/3/MB^2 == WA)
assert((2*MA^3-9*MA)/27/MB^3 == WB)

Wx = Mx/MB + MA/3/MB
Wy = My/MB

assert(Wy^2 - Wx^3 - WA * Wx - WB == 0)